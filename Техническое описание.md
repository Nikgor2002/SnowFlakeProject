## Описание архитектуры программы
## 1. Введение
Целью создания нашей программы было показать возможности Unity в создании реалистичных эффектов погоды. В этом проекте мы использовали различные техники и инструменты Unity, чтобы создать реалистичную симуляцию падения снега. Мы использовали систему частиц, чтобы создать эффект падающего снега, а также добавили звуковые эффекты, чтобы усилить ощущение присутствия. Кроме того, мы добавили возможность настройки параметров симуляции, таких как температура, количество частиц снега, вектор направление ветра и т.п. чтобы пользователи могли настроить симуляцию под свои потребности.
## 2. Общая архитектура
В нашей программе участвует 10 модулей.  
1." Main Camera" - встроенный модуль unity для изменения местоположения и угла обзора камеры.  
2."snegovik" - модель снеговика, представляет собой чисто декоративный элемент.  
3." SnowyMountain_V2_Mesh" - локация в виде гор.  
4." Directional Light" - источник света, вспомогательное средство для погоды.  
5."snow" - снег.  
6."THOR_Thunderstorm" - отвечает за эффекты грозы и молнии.  
7."rain" - дождь.  
8." Enviro Directional Light" - отвечает за отражения объектами лучей солнца.  
9." EnviroSky" - отвечает за смену погоды, с множеством настроек.  
10." Enviro Effects" - отвечает за эффекты погоды.  
## Архитектура модулей
## "snow"
Модуль снега состоит из стандартной для unity системы частиц и нашего скрипта.
Рассмотрим скрип поподробнее.
В нем имеется 1 класс - Snowflake, наследующий функции у класса "MonoBehaviour". Класс MonoBehaviour предоставляет структуру, позволяющую прикрепить сценарий к GameObject в редакторе, а также ссылки на полезные события, такие как "Запуск" и "Обновление".
Имеется 11 полей:  
1."snowMaterial" хранит в себе текстуру для частицы(в данном случае снежинку).    
2."particleSize" определяет размер частицы.  
3."windDirection" - 3-х мерный вектор для хранения информации о ветре.  
4."temperature" - переменная, хранящая значение температуры.  
5."countSnowflake" - переменная, хранящая количество снежинок.  
6."particleSystem" - хранит систему частиц.  
7."mainModule" - модуль, создаваемый по умолчанию.  
8."emissionModule" - модуль, создаваемый по умолчанию.  
9."_tick" - переменная для времени.  
10"._startLocation" - определяет стартовую локацию.  
в этом скрипте только 2 функции: "start" и "update".  
В функции "start" задаётся начальное положение, выбирается система частиц, время жизни объекта, его скорость и размер, максимальное количество объектов.
Компонент "Rotation over lifetime" отвечает за вращение снежинок в зависимости от ветра. Условие в конце останавливает появление снежинок, если температура выше или равна 3.
За движение снежинок отвечает функция "Update".
В ней задаётся единица времени, и траектория движения снежинок. Для создания максимально правдоподобного движения, снежинки спускаются по винтовой линии, и откланяются с учётом направления и силы ветра.
## "rain"
Дождь повторяет структуру снега, но имеет одну особенность. Капли дождя летят по прямой линии, и откланяются с учётом направления и силы ветра.
## "Directional Light", "THOR_Thunderstorm", "Enviro Directional Light", "EnviroSky" и "Enviro Effects".
-["Directional Light"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content), -["THOR_Thunderstorm"](https://assetstore.unity.com/packages/tools/particles-effects/thor-thunderstorm-103956), -["Enviro Directional Light"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content), ["EnviroSky"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content) и ["Enviro Effects"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content) являются сторонними технологиями, используемыми для улучшения внешнего вида симуляции, добавления возможности менять погоду.  
## Перечень используемых технологий и библиотек  
-["Directional Light"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content), -["THOR_Thunderstorm"](https://assetstore.unity.com/packages/tools/particles-effects/thor-thunderstorm-103956), -["Enviro Directional Light"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content), ["EnviroSky"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content) и ["Enviro Effects"](https://assetstore.unity.com/packages/tools/particles-effects/enviro-sky-and-weather-33963#content) — сторонние технологии.

## Тесты программы, при различных значениях параметров. 
Первый случай: snow : wind direction : x = 3, y = 1, z = 3, temperature = -1, Count Snowflake = 20000. rain : wind direction x = 10, y = 40, z = 0, temperature = - 1, Count Rain = 20000
Результат: Выпадает снег, движется плавно, поворачивает плавно, дождь не падает, при таком количестве частиц количество кадров в секунду не опускалось ниже 110.  
Второй случай : snow : wind direction : x = 30, y = 10, z = 30, temperature = 2, Count Snowflake = 100000. rain : wind direction x = 100, y = 400, z = 0, temperature = 2, Count Rain = 100000
Результат: частицы падают отчень быстро, разлечить их на глаз становиться практически невозможно, 30 блоков в unity - слишком большая дистанция, с течением времени частицы отдаляются слишком далеко. 
Поэтому мы рекомендуем не поднимать значение ветра выше 10.  
Третий случай: snow : wind direction : x = 7, y = 0, z = 7, temperature = 3, Count Snowflake = 100000. rain : wind direction x = 0, y = 20, z = 0, temperature = 3, Count Rain = 100000.  
Результат: Снег не выпадает, дождь падает достаточно быстро, с откланением в стороны, количество кадров в секунду калебалось, но оставалось в районе 50.  
Теперь залезем в код, поменяем следующие параметры: "mainModule.startLifetime", "rotationModule.z", "rotationModule.x", "rotationModule.y" и посмотрим как это отразится на программе.
При увеличении времени жизни снежинок они продолжают падать за текстуры и не пропадают, в связи с чем поднимается нагрузка на систему. При уменьшении этого параметра, снежинки начали пропадать не долетая до земли.
Посмотрим из чего состоит rotationModule. rotationModule.z = windDirection[2] / 3f; Поменяем делитель. Так как расчёт происходит в радианах, любое измение дилителя сильно сказывается на вращении снежинки.
При делении на 6, снежинки вращаются значительно медленее, а в случае с 1 - значительно быстрее. 
